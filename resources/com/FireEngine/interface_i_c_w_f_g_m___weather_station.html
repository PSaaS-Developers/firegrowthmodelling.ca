<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>FireEngine</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
<link href="../banner.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<div class="banner">
  <img class="left" src="../Prometheus_Icon_064x050.png" alt="Prometheus">
  <div class="bannertitle"><h1>COM Programmer Documentation</h1></div>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../PrometheusCOM/index.html"><span>PrometheusCOM</span></a></li>
      <li class="current"><a href="index.html"><span>FireEngine</span></a></li>
      <li><a href="../FuelCom/index.html"><span>FuelCom</span></a></li>
      <li><a href="../FWICom/index.html"><span>FWICom</span></a></li>
      <li><a href="../GridCom/index.html"><span>GridCom</span></a></li>
      <li><a href="../WeatherCom/index.html"><span>WeatherCom</span></a></li>
    </ul>
  </div><!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Properties</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="class_i_c_w_f_g_m___weather_station-members.html">List of all members</a> &#124;
<a href="interface_i_c_w_f_g_m___weather_station.html#pub-methods">Public Member Functions</a> &#124;
<a href="interface_i_c_w_f_g_m___weather_station.html#properties">Properties</a>  </div>
  <div class="headertitle">
<div class="title">ICWFGM_WeatherStation Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Interface ICWFGM WeatherStation.  
 <a href="interface_i_c_w_f_g_m___weather_station.html#details">More...</a></p>

<p><code>import &quot;WeatherCOM.idl&quot;;</code></p>
<div class="dynheader">
Collaboration diagram for ICWFGM_WeatherStation:</div>
<div class="dyncontent">
<div class="center"><img src="interface_i_c_w_f_g_m___weather_station__coll__graph.png" border="0" usemap="#_i_c_w_f_g_m___weather_station_coll__map" alt="Collaboration graph"/></div>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:accc67daf0f1dd96616c6a85cc3eee01c"><td class="memItemLeft" align="right" valign="top">HRESULT&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interface_i_c_w_f_g_m___weather_station.html#accc67daf0f1dd96616c6a85cc3eee01c">MT_Lock</a> ([in] unsigned short exclusive, [in] unsigned short obtain)</td></tr>
<tr class="separator:accc67daf0f1dd96616c6a85cc3eee01c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d2991b3edfa3e8349e68a3f7c94eaac"><td class="memItemLeft" align="right" valign="top">HRESULT&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interface_i_c_w_f_g_m___weather_station.html#a2d2991b3edfa3e8349e68a3f7c94eaac">Clone</a> ([out]<a class="el" href="interface_i_c_w_f_g_m___weather_station.html">ICWFGM_WeatherStation</a> **newWeatherStation)</td></tr>
<tr class="separator:a2d2991b3edfa3e8349e68a3f7c94eaac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afde53c32ae13e8aaef51805025e2d743"><td class="memItemLeft" align="right" valign="top">HRESULT&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interface_i_c_w_f_g_m___weather_station.html#afde53c32ae13e8aaef51805025e2d743">GetStreamCount</a> ([out, retval]unsigned long *count)</td></tr>
<tr class="separator:afde53c32ae13e8aaef51805025e2d743"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac77895669e9c0a2c2a34e6f0843cce26"><td class="memItemLeft" align="right" valign="top">HRESULT&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interface_i_c_w_f_g_m___weather_station.html#ac77895669e9c0a2c2a34e6f0843cce26">AddStream</a> ([in]ICWFGM_WeatherStream *stream, [in]unsigned long index)</td></tr>
<tr class="separator:ac77895669e9c0a2c2a34e6f0843cce26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad204417d78967c756c0e69a39efe4792"><td class="memItemLeft" align="right" valign="top">HRESULT&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interface_i_c_w_f_g_m___weather_station.html#ad204417d78967c756c0e69a39efe4792">RemoveStream</a> ([in]ICWFGM_WeatherStream *stream)</td></tr>
<tr class="separator:ad204417d78967c756c0e69a39efe4792"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9975d6c813f4573a823b2052bcac8d6"><td class="memItemLeft" align="right" valign="top">HRESULT&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interface_i_c_w_f_g_m___weather_station.html#aa9975d6c813f4573a823b2052bcac8d6">StreamAtIndex</a> ([in]unsigned long index, [out, retval]ICWFGM_WeatherStream **stream)</td></tr>
<tr class="separator:aa9975d6c813f4573a823b2052bcac8d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1325a2257c492363156a77635b437b6"><td class="memItemLeft" align="right" valign="top">HRESULT&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interface_i_c_w_f_g_m___weather_station.html#af1325a2257c492363156a77635b437b6">IndexOfStream</a> ([in]ICWFGM_WeatherStream *stream, [out, retval]unsigned long *index)</td></tr>
<tr class="separator:af1325a2257c492363156a77635b437b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bca6e6d34d9c8da00eb0c5e1a611405"><td class="memItemLeft" align="right" valign="top">HRESULT&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interface_i_c_w_f_g_m___weather_station.html#a0bca6e6d34d9c8da00eb0c5e1a611405">GetAttribute</a> ([in]unsigned short option, [out, retval] VARIANT *value)</td></tr>
<tr class="separator:a0bca6e6d34d9c8da00eb0c5e1a611405"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a070f68abb4c3a6991175d11d023b6832"><td class="memItemLeft" align="right" valign="top">HRESULT&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interface_i_c_w_f_g_m___weather_station.html#a070f68abb4c3a6991175d11d023b6832">SetAttribute</a> ([in]unsigned short option, [in] VARIANT value)</td></tr>
<tr class="separator:a070f68abb4c3a6991175d11d023b6832"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="properties"></a>
Properties</h2></td></tr>
<tr class="memitem:a9d626d928a8343a761f51c47e9cd34fc"><td class="memItemLeft" align="right" valign="top">VARIANT&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interface_i_c_w_f_g_m___weather_station.html#a9d626d928a8343a761f51c47e9cd34fc">UserData</a><code> [get, set]</code></td></tr>
<tr class="separator:a9d626d928a8343a761f51c47e9cd34fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Interface ICWFGM WeatherStation. </p>
<p>This object maintains a collection of weather streams. A variety of streams may co-exist to provide a useful comparison of results in different scenarios. It also supports the standard COM IPersistStream, IPersistStreamInit, and IPersistStorage interfaces. Any weather stream is automatically saved with the station in order to simplify serialization operations in the client application. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="ac77895669e9c0a2c2a34e6f0843cce26"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ICWFGM_WeatherStation::AddStream </td>
          <td>(</td>
          <td class="paramtype">[in] ICWFGM_WeatherStream *&#160;</td>
          <td class="paramname"><em>stream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">[in] unsigned long&#160;</td>
          <td class="paramname"><em>index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Adds a weather stream to this weather station. This stream may be in any state (initialized, newly created, or containing data). Any calculated data in the weather stream will be marked invalid to use the location and time zone of this weather station. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">stream</td><td>A weather stream object. </td></tr>
    <tr><td class="paramname">index</td><td>Index (0-based) for where to insert the stream into the set. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a2d2991b3edfa3e8349e68a3f7c94eaac"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ICWFGM_WeatherStation::Clone </td>
          <td>(</td>
          <td class="paramtype">[out] <a class="el" href="interface_i_c_w_f_g_m___weather_station.html">ICWFGM_WeatherStation</a> **&#160;</td>
          <td class="paramname"><em>newWeatherStation</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates a new weather station with all the same properties of the object being called, returns a handle to the new object in 'newWeatherStation'. Any weather streams associated with this object are also duplicated for the new station. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">newWeatherStation</td><td>A weather station object. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a0bca6e6d34d9c8da00eb0c5e1a611405"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ICWFGM_WeatherStation::GetAttribute </td>
          <td>(</td>
          <td class="paramtype">[in] unsigned short&#160;</td>
          <td class="paramname"><em>option</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">[out, retval] VARIANT *&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Gets the value of an "option" and saves it in the "value" variable provided. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">option</td><td>The option that you want the value of (Longitude, Latitude or Elevation). Valid values are: <ul>
<li>
<code>CWFGM_GRID_ATTRIBUTE_LATITUDE</code> 64-bit floating point, radians. </li>
<li>
<code>CWFGM_GRID_ATTRIBUTE_LONGITUDE</code> 64-bit floating point, radians. </li>
<li>
<code>CWFGM_GRID_ATTRIBUTE_DEFAULT_ELEVATION</code> 64-bit floating point, metres. User specified elevation to use when there is no grid elevation available for at a requested grid location. </li>
<li>
<code>CWFGM_ATTRIBUTE_LOAD_WARNING</code> BSTR. Any warnings generated by the COM object when deserializating. </li>
</ul>
</td></tr>
    <tr><td class="paramname">value</td><td>A pointer to a variable that you want the value to be saved in. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="afde53c32ae13e8aaef51805025e2d743"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ICWFGM_WeatherStation::GetStreamCount </td>
          <td>(</td>
          <td class="paramtype">[out, retval] unsigned long *&#160;</td>
          <td class="paramname"><em>count</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Returns the number of streams associated with this weather station. Any number of streams can be associated with a given weather station and be assigned different values, options, and time ranges. However, only one stream from a station can be associated with a scenario at a given time. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">count</td><td>Number of streams. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="af1325a2257c492363156a77635b437b6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ICWFGM_WeatherStation::IndexOfStream </td>
          <td>(</td>
          <td class="paramtype">[in] ICWFGM_WeatherStream *&#160;</td>
          <td class="paramname"><em>stream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">[out, retval] unsigned long *&#160;</td>
          <td class="paramname"><em>index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Returns the index of 'stream' in this station's set of streams. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">stream</td><td>A weather stream object. </td></tr>
    <tr><td class="paramname">index</td><td>The index of stream. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="accc67daf0f1dd96616c6a85cc3eee01c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ICWFGM_WeatherStation::MT_Lock </td>
          <td>(</td>
          <td class="paramtype">[in] unsigned short&#160;</td>
          <td class="paramname"><em>exclusive</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">[in] unsigned short&#160;</td>
          <td class="paramname"><em>obtain</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Changes the state of the object with respect to access rights. When the object is used by an active simulation, it must not be modified. When the object is somehow modified, it must be done so in an atomic action to prevent concerns with arising from multithreading. Note that these locks are primarily needed to ensure a simulation dependency is not changed while it occurs. All routines are otherwise multi-thread safe. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">exclusive</td><td>TRUE if the requester wants a write lock, FALSE for read/shared access </td></tr>
    <tr><td class="paramname">obtain</td><td>TRUE to obtain the lock, FALSE to release the lock. If this is FALSE, then the 'exclusive' parameter must match the initial call used to obtain the lock. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ad204417d78967c756c0e69a39efe4792"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ICWFGM_WeatherStation::RemoveStream </td>
          <td>(</td>
          <td class="paramtype">[in] ICWFGM_WeatherStream *&#160;</td>
          <td class="paramname"><em>stream</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Removes an association between a weather stream and this weather station. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">stream</td><td>A weather stream object. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a070f68abb4c3a6991175d11d023b6832"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ICWFGM_WeatherStation::SetAttribute </td>
          <td>(</td>
          <td class="paramtype">[in] unsigned short&#160;</td>
          <td class="paramname"><em>option</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">[in] VARIANT&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Sets the value of an "option" to the value of the "value" variable provided. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">option</td><td>The option that you want the value of (Longitude, Latitude or Default Elevation). Valid values are: <ul>
<li>
<code>CWFGM_GRID_ATTRIBUTE_LATITUDE</code> 64-bit floating point, radians. </li>
<li>
<code>CWFGM_GRID_ATTRIBUTE_LONGITUDE</code> 64-bit floating point, radians. </li>
<li>
<code>CWFGM_GRID_ATTRIBUTE_DEFAULT_ELEVATION</code> 64-bit floating point, metres. User specified elevation to use when there is no grid elevation available for at a requested grid location. </li>
</ul>
</td></tr>
    <tr><td class="paramname">value</td><td>The new value for the "option" </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="aa9975d6c813f4573a823b2052bcac8d6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ICWFGM_WeatherStation::StreamAtIndex </td>
          <td>(</td>
          <td class="paramtype">[in] unsigned long&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">[out,retval] ICWFGM_WeatherStream **&#160;</td>
          <td class="paramname"><em>stream</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Given an index value, returns a pointer to a specific stream associated with this station. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">index</td><td>Index to a weather stream </td></tr>
    <tr><td class="paramname">stream</td><td>Address to contain the specific requested weather stream. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Property Documentation</h2>
<a class="anchor" id="a9d626d928a8343a761f51c47e9cd34fc"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Property ICWFGM_WeatherStation::UserData</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">get</span><span class="mlabel">set</span><span class="mlabel">property</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This property is unused by this object, and is available for exclusive use by the client code. It is a VARIANT value to ensure that the client code can store a pointer value (if it chooses) for use in manual subclassing this object. This value is not loaded or saved during serialization operations, and it is the responsibility of the client code to manage any value or object stored here. Access to this property is not thread-safe. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pVal</td><td>Value of UserData. </td></tr>
    <tr><td class="paramname">newVal</td><td>Replacement value for UserData. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<hr class="footer"/><address class="footer"><small>Generated on Mon Sep 8 2014 21:08:08</address>
</body>
</html>
